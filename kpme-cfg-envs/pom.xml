<?xml version="1.0" encoding="UTF-8"?>
<!--
        Copyright 2008-2009 The Kuali Foundation Licensed under the
        Educational Community License, Version 2.0 (the "License"); you may
        not use this file except in compliance with the License. You may
        obtain a copy of the License at
        http://www.opensource.org/licenses/ecl2.php Unless required by
        applicable law or agreed to in writing, software distributed under the
        License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
        CONDITIONS OF ANY KIND, either express or implied. See the License for
        the specific language governing permissions and limitations under the
        License.
-->
<project xmlns="http://maven.apache.org/POM/4.0.0" 
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    
    <modelVersion>4.0.0</modelVersion>
    <groupId>org.kuali.kpme</groupId>
    <artifactId>kpme-cfg-envs</artifactId>
    <version>1.0.0</version>
    <packaging>jar</packaging>
    <name>KPME Configuration Environment Tool</name>
    <url>http://kuali.org/kpme</url>
    <organization>
        <name>The Kuali Foundation</name>
        <url>http://kuali.org</url>
    </organization>
    
    <licenses>
        <license>
            <name>The Kuali Foundation Educational Community License 2.0</name>
            <url>http://www.opensource.org/licenses/ecl2.txt</url>
            <distribution>manual</distribution>
        </license>
    </licenses>
    
    <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        
        <dba.environment>dba</dba.environment>
        <build.environment>dev</build.environment>
    </properties>
    
    <build>
        <pluginManagement>
            <plugins>
                <plugin>
	                <groupId>org.apache.maven.plugins</groupId>
	                <artifactId>maven-antrun-plugin</artifactId>
	                <version>1.7</version>
                </plugin>
                <plugin>
	                <groupId>org.apache.maven.plugins</groupId>
	                <artifactId>maven-invoker-plugin</artifactId>
	                <version>1.6</version>
                </plugin>
                <plugin>
	                <groupId>org.apache.maven.plugins</groupId>
	                <artifactId>maven-resources-plugin</artifactId>
	                <version>2.5</version>
                </plugin>
                <plugin>
	                <groupId>org.apache.maven.plugins</groupId>
	                <artifactId>maven-scm-plugin</artifactId>
	                <version>1.7</version>
                </plugin>
                <plugin>
                    <groupId>org.eclipse.m2e</groupId>
                    <artifactId>lifecycle-mapping</artifactId>
                    <version>1.0.0</version>
                    <configuration>
                        <lifecycleMappingMetadata>
                            <pluginExecutions>
                                <pluginExecution>
                                    <pluginExecutionFilter>
                                        <groupId>org.apache.maven.plugins</groupId>
                                        <artifactId>maven-antrun-plugin</artifactId>
                                        <versionRange>[1.0-alpha-1,)</versionRange>
                                        <goals>
                                            <goal>run</goal>
                                        </goals>
                                    </pluginExecutionFilter>
                                    <action>
                                        <ignore />
                                    </action>
                                </pluginExecution>
                                <pluginExecution>
                                    <pluginExecutionFilter>
                                        <groupId>org.apache.maven.plugins</groupId>
                                        <artifactId>maven-scm-plugin</artifactId>
                                        <versionRange>[1.0-alpha-2,)</versionRange>
                                        <goals>
                                            <goal>checkout</goal>
                                        </goals>
                                    </pluginExecutionFilter>
                                    <action>
                                        <ignore />
                                    </action>
                                </pluginExecution>
                                <pluginExecution>
                                    <pluginExecutionFilter>
                                        <groupId>org.kuali.maven.plugins</groupId>
						                <artifactId>maven-impex-plugin</artifactId>
						                <versionRange>[1.0.2-SNAPSHOT,)</versionRange>
                                        <goals>
                                            <goal>exportschema</goal>
                                            <goal>exportdata</goal>
                                            <goal>datadtd</goal>
                                            <goal>schemasql</goal>
                                            <goal>datasql</goal>
                                            <goal>reset</goal>
                                            <goal>import</goal>
                                        </goals>
                                    </pluginExecutionFilter>
                                    <action>
                                        <ignore />
                                    </action>
                                </pluginExecution>
                                <pluginExecution>
                                    <pluginExecutionFilter>
                                        <groupId>org.apache.maven.plugins</groupId>
                                        <artifactId>maven-invoker-plugin</artifactId>
                                        <versionRange>[1.0,)</versionRange>
                                        <goals>
                                            <goal>run</goal>
                                        </goals>
                                    </pluginExecutionFilter>
                                    <action>
                                        <ignore />
                                    </action>
                                </pluginExecution>
                            </pluginExecutions>
                        </lifecycleMappingMetadata>
                    </configuration>
                </plugin>
                <plugin>
	                <groupId>org.kuali.maven.plugins</groupId>
	                <artifactId>maven-impex-plugin</artifactId>
	                <version>1.1.0</version>
	                <dependencies>
	                    <dependency>
	                        <groupId>mysql</groupId>
	                        <artifactId>mysql-connector-java</artifactId>
	                        <version>5.1.5</version>
	                    </dependency>
	                </dependencies>
	            </plugin>
            </plugins>
        </pluginManagement>
    </build>
    
    <profiles>
        <profile>
            <id>export</id>
            <build>
                <plugins>
                     <plugin>
		                <groupId>org.kuali.maven.plugins</groupId>
		                <artifactId>maven-impex-plugin</artifactId>
		                <executions>
		                    <execution>
		                        <id>export-krdba</id>
		                        <phase>generate-sources</phase>
		                        <goals>
		                            <goal>exportdata</goal>
		                            <goal>exportschema</goal>
		                            <goal>datadtd</goal>
		                        </goals>
		                        <configuration>
		                            <artifactId>${krdba.dataSource.database}</artifactId>
		                            <dateFormat>yyyyMMddHHmmss</dateFormat>
		                            <driver>${krdba.dataSource.driver}</driver>
		                            <url>${krdba.dataSource.jdbcUrl}</url>
		                            <username>${krdba.dataSource.username}</username>
		                            <password>${krdba.dataSource.password}</password>
		                            <outputDir>${project.build.directory}/impex/</outputDir>
		                            <dataXMLDir>${project.build.directory}/impex/${krdba.dataSource.database}</dataXMLDir>
		                            <schemaXMLFile>${project.build.directory}/impex/${krdba.dataSource.database}.xml</schemaXMLFile>
		                        </configuration>
		                    </execution>
		                    <execution>
		                        <id>export-kpmedba</id>
		                        <phase>generate-sources</phase>
		                        <goals>
		                            <goal>exportdata</goal>
		                            <goal>exportschema</goal>
		                            <goal>datadtd</goal>
		                        </goals>
		                        <configuration>
		                            <artifactId>${kpmedba.dataSource.database}</artifactId>
		                            <dateFormat>yyyyMMddHHmmss</dateFormat>
		                            <driver>${kpmedba.dataSource.driver}</driver>
		                            <url>${kpmedba.dataSource.jdbcUrl}</url>
		                            <username>${kpmedba.dataSource.username}</username>
		                            <password>${kpmedba.dataSource.password}</password>
		                            <outputDir>${project.build.directory}/impex/</outputDir>
		                            <dataXMLDir>${project.build.directory}/impex/${kpmedba.dataSource.database}</dataXMLDir>
		                            <schemaXMLFile>${project.build.directory}/impex/${kpmedba.dataSource.database}.xml</schemaXMLFile>
		                        </configuration>
		                    </execution>
		                    <execution>
		                        <id>convert-schema-krdba-oracle</id>
		                        <phase>generate-sources</phase>
		                        <goals>
		                            <goal>schemasql</goal>
		                        </goals>
		                        <configuration>
		                            <targetDatabase>oracle</targetDatabase>
		                            <schemaXMLFile>${project.build.directory}/impex/${krdba.dataSource.database}.xml</schemaXMLFile>
		                            <schemaDir>${project.build.directory}/impex</schemaDir>
		                            <schemaIncludes>${krdba.dataSource.database}.xml</schemaIncludes>
		                            <outputDir>${project.build.directory}/schema-sql/${krdba.dataSource.database}</outputDir>
		                            <runOnlyOnSchemaChange>false</runOnlyOnSchemaChange>
		                        </configuration>
		                    </execution>
		                    <execution>
		                        <id>convert-schema-krdba-mysql</id>
		                        <phase>generate-sources</phase>
		                        <goals>
		                            <goal>schemasql</goal>
		                        </goals>
		                        <configuration>
		                            <targetDatabase>mysql</targetDatabase>
		                            <schemaXMLFile>${project.build.directory}/impex/${krdba.dataSource.database}.xml</schemaXMLFile>
		                            <schemaDir>${project.build.directory}/impex</schemaDir>
		                            <schemaIncludes>${krdba.dataSource.database}.xml</schemaIncludes>
		                            <outputDir>${project.build.directory}/schema-sql/${krdba.dataSource.database}</outputDir>
		                            <runOnlyOnSchemaChange>false</runOnlyOnSchemaChange>
		                        </configuration>
		                    </execution>
		                    <execution>
		                        <id>convert-schema-kpmedba-oracle</id>
		                        <phase>generate-sources</phase>
		                        <goals>
		                            <goal>schemasql</goal>
		                        </goals>
		                        <configuration>
		                            <targetDatabase>oracle</targetDatabase>
		                            <schemaXMLFile>${project.build.directory}/impex/${kpmedba.dataSource.database}.xml</schemaXMLFile>
		                            <schemaDir>${project.build.directory}/impex</schemaDir>
		                            <schemaIncludes>${kpmedba.dataSource.database}.xml</schemaIncludes>
		                            <outputDir>${project.build.directory}/schema-sql/${kpmedba.dataSource.database}</outputDir>
		                            <runOnlyOnSchemaChange>false</runOnlyOnSchemaChange>
		                        </configuration>
		                    </execution>
		                    <execution>
		                        <id>convert-schema-kpmedba-mysql</id>
		                        <phase>generate-sources</phase>
		                        <goals>
		                            <goal>schemasql</goal>
		                        </goals>
		                        <configuration>
		                            <targetDatabase>mysql</targetDatabase>
		                            <schemaXMLFile>${project.build.directory}/impex/${kpmedba.dataSource.database}.xml</schemaXMLFile>
		                            <schemaDir>${project.build.directory}/impex</schemaDir>
		                            <schemaIncludes>${kpmedba.dataSource.database}.xml</schemaIncludes>
		                            <outputDir>${project.build.directory}/schema-sql/${kpmedba.dataSource.database}</outputDir>
		                            <runOnlyOnSchemaChange>false</runOnlyOnSchemaChange>
		                        </configuration>
		                    </execution>
		                    <execution>
		                        <id>convert-data-krdba-oracle</id>
		                        <phase>generate-sources</phase>
		                        <goals>
		                            <goal>datasql</goal>
		                        </goals>
		                        <configuration>
		                            <targetDatabase>oracle</targetDatabase>
		                            <schemaXMLFile>${project.build.directory}/impex/${krdba.dataSource.database}.xml</schemaXMLFile>
		                            <schemaDir>${project.build.directory}/impex</schemaDir>
		                            <schemaIncludes>${krdba.dataSource.database}.xml</schemaIncludes>
		                            <dataXMLDir>${project.build.directory}/impex/${krdba.dataSource.database}</dataXMLDir>
		                            <dataXMLExcludes>krsb_qrtz_blob_triggers.xml,krsb_qrtz_calendars.xml,krsb_qrtz_cron_triggers.xml,krsb_qrtz_fired_triggers.xml,krsb_qrtz_job_details.xml,krsb_qrtz_job_listeners.xml,krsb_qrtz_paused_trigger_grps.xml,krsb_qrtz_scheduler_state.xml,krsb_qrtz_simple_triggers.xml,krsb_qrtz_trigger_listeners.xml,krsb_qrtz_triggers.xml</dataXMLExcludes>
		                            <dataDTD>${project.build.directory}/impex/${krdba.dataSource.database}.dtd</dataDTD>
		                            <outputDir>${project.build.directory}/data-sql/${krdba.dataSource.database}</outputDir>
		                            <runOnlyOnChange>false</runOnlyOnChange>
		                        </configuration>
		                    </execution>
		                    <execution>
		                        <id>convert-data-krdba-mysql</id>
		                        <phase>generate-sources</phase>
		                        <goals>
		                            <goal>datasql</goal>
		                        </goals>
		                        <configuration>
		                            <targetDatabase>mysql</targetDatabase>
		                            <schemaXMLFile>${project.build.directory}/impex/${krdba.dataSource.database}.xml</schemaXMLFile>
		                            <schemaDir>${project.build.directory}/impex</schemaDir>
		                            <schemaIncludes>${krdba.dataSource.database}.xml</schemaIncludes>
		                            <dataXMLDir>${project.build.directory}/impex/${krdba.dataSource.database}</dataXMLDir>
		                            <dataXMLExcludes>krsb_qrtz_blob_triggers.xml,krsb_qrtz_calendars.xml,krsb_qrtz_cron_triggers.xml,krsb_qrtz_fired_triggers.xml,krsb_qrtz_job_details.xml,krsb_qrtz_job_listeners.xml,krsb_qrtz_paused_trigger_grps.xml,krsb_qrtz_scheduler_state.xml,krsb_qrtz_simple_triggers.xml,krsb_qrtz_trigger_listeners.xml,krsb_qrtz_triggers.xml</dataXMLExcludes>
		                            <dataDTD>${project.build.directory}/impex/${krdba.dataSource.database}.dtd</dataDTD>
		                            <outputDir>${project.build.directory}/data-sql/${krdba.dataSource.database}</outputDir>
		                            <runOnlyOnChange>false</runOnlyOnChange>
		                        </configuration>
		                    </execution>
		                    <execution>
		                        <id>convert-data-kpmedba-oracle</id>
		                        <phase>generate-sources</phase>
		                        <goals>
		                            <goal>datasql</goal>
		                        </goals>
		                        <configuration>
		                            <targetDatabase>oracle</targetDatabase>
		                            <schemaXMLFile>${project.build.directory}/impex/${kpmedba.dataSource.database}.xml</schemaXMLFile>
		                            <schemaDir>${project.build.directory}/impex</schemaDir>
		                            <schemaIncludes>${kpmedba.dataSource.database}.xml</schemaIncludes>
		                            <dataXMLDir>${project.build.directory}/impex/${kpmedba.dataSource.database}</dataXMLDir>
		                            <dataDTD>${project.build.directory}/impex/${kpmedba.dataSource.database}.dtd</dataDTD>
		                            <outputDir>${project.build.directory}/data-sql/${kpmedba.dataSource.database}</outputDir>
		                            <runOnlyOnChange>false</runOnlyOnChange>
		                        </configuration>
		                    </execution>
		                    <execution>
		                        <id>convert-data-kpmedba-mysql</id>
		                        <phase>generate-sources</phase>
		                        <goals>
		                            <goal>datasql</goal>
		                        </goals>
		                        <configuration>
		                            <targetDatabase>mysql</targetDatabase>
		                            <schemaXMLFile>${project.build.directory}/impex/${kpmedba.dataSource.database}.xml</schemaXMLFile>
		                            <schemaDir>${project.build.directory}/impex</schemaDir>
		                            <schemaIncludes>${kpmedba.dataSource.database}.xml</schemaIncludes>
		                            <dataXMLDir>${project.build.directory}/impex/${kpmedba.dataSource.database}</dataXMLDir>
		                            <dataDTD>${project.build.directory}/impex/${kpmedba.dataSource.database}.dtd</dataDTD>
		                            <outputDir>${project.build.directory}/data-sql/${kpmedba.dataSource.database}</outputDir>
		                            <runOnlyOnChange>false</runOnlyOnChange>
		                        </configuration>
		                    </execution>
		                </executions>
		            </plugin>
		            <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-antrun-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>create-scripts-mysql</id>
                                <phase>generate-sources</phase>
                                <goals>
                                    <goal>run</goal>
                                </goals>
                                <configuration>
                                    <target>
                                        <fileset id="mysql-server-schema" file="${project.build.directory}/schema-sql/${krdba.dataSource.database}/mysql/${krdba.dataSource.database}.sql" />
                                        <fileset id="mysql-server-constraints" file="${project.build.directory}/schema-sql/${krdba.dataSource.database}/mysql/${krdba.dataSource.database}-constraints.sql" />
                                        <fileset id="mysql-client-schema" file="${project.build.directory}/schema-sql/${kpmedba.dataSource.database}/mysql/${kpmedba.dataSource.database}.sql" />
                                        <fileset id="mysql-client-constraints" file="${project.build.directory}/schema-sql/${kpmedba.dataSource.database}/mysql/${kpmedba.dataSource.database}-constraints.sql" />
                                        <fileset id="mysql-server-data" dir="${project.build.directory}/data-sql/${krdba.dataSource.database}/mysql" />                                        
                                        <fileset id="mysql-client-data" dir="${project.build.directory}/data-sql/${kpmedba.dataSource.database}/mysql" />
                                        
                                        <pathconvert property="mysql-server-schema-script" refid="mysql-server-schema" pathsep="${line.separator}">
                                            <chainedmapper>
                                                <flattenmapper />
                                                <filtermapper>
                                                    <replacestring from="${krdba.dataSource.database}.sql" to="\. mysql/server/schema/schema.sql" />
                                                </filtermapper>
                                            </chainedmapper>
                                        </pathconvert>
                                        <pathconvert property="mysql-server-constraints-script" refid="mysql-server-constraints" pathsep="${line.separator}">
                                            <chainedmapper>
                                                <flattenmapper />
                                                <filtermapper>
                                                    <replacestring from="${krdba.dataSource.database}-constraints.sql" to="\. mysql/server/schema/schema-constraints.sql" />
                                                </filtermapper>
                                            </chainedmapper>
                                        </pathconvert>
                                        <pathconvert property="mysql-client-schema-script" refid="mysql-client-schema" pathsep="${line.separator}">
                                            <chainedmapper>
                                                <flattenmapper />
                                                <filtermapper>
                                                    <replacestring from="${kpmedba.dataSource.database}.sql" to="\. mysql/client/data/schema.sql" />
                                                </filtermapper>
                                            </chainedmapper>
                                        </pathconvert>
                                        <pathconvert property="mysql-client-constraints-script" refid="mysql-client-constraints" pathsep="${line.separator}">
                                            <chainedmapper>
                                                <flattenmapper />
                                                <filtermapper>
                                                    <replacestring from="${kpmedba.dataSource.database}-constraints.sql" to="\. mysql/client/schema/schema-constraints.sql" />
                                                </filtermapper>
                                            </chainedmapper>
                                        </pathconvert>
                                        <pathconvert property="mysql-server-data-script" refid="mysql-server-data" pathsep="${line.separator}">
                                            <chainedmapper>
	                                            <flattenmapper />
	                                            <globmapper from="*.sql" to="\. mysql/server/data/*.sql" />
                                            </chainedmapper>
                                        </pathconvert>
                                        <pathconvert property="mysql-client-data-script" refid="mysql-client-data" pathsep="${line.separator}">
                                            <chainedmapper>
                                                <flattenmapper />
                                                <globmapper from="*.sql" to="\. mysql/client/data/*.sql" />
                                            </chainedmapper>
                                        </pathconvert>
                                        
                                        <echo message="${line.separator}${mysql-server-schema-script}${line.separator}${mysql-server-data-script}${line.separator}${mysql-server-constraints-script}" file="${project.build.directory}/mysql_${dba.environment}/mysql_server.sql" />
                                        <echo message="${line.separator}${mysql-client-schema-script}${line.separator}${mysql-client-data-script}${line.separator}${mysql-client-constraints-script}" file="${project.build.directory}/mysql_${dba.environment}/mysql_client.sql" />
                                        
                                        <zip destfile="${project.build.directory}/mysql_${dba.environment}.zip">
                                            <zipfileset dir="${project.build.directory}/schema-sql/${krdba.dataSource.database}/mysql" includes="${krdba.dataSource.database}.sql" fullpath="mysql/server/schema/schema.sql" />
                                            <zipfileset dir="${project.build.directory}/schema-sql/${krdba.dataSource.database}/mysql" includes="${krdba.dataSource.database}-constraints.sql" fullpath="mysql/server/schema/schema-constraints.sql" />
                                            <zipfileset dir="${project.build.directory}/schema-sql/${kpmedba.dataSource.database}/mysql" includes="${kpmedba.dataSource.database}.sql" fullpath="mysql/client/schema/schema.sql" />
                                            <zipfileset dir="${project.build.directory}/schema-sql/${kpmedba.dataSource.database}/mysql" includes="${kpmedba.dataSource.database}-constraints.sql" fullpath="mysql/client/schema/schema-constraints.sql" />
                                            <zipfileset dir="${project.build.directory}/data-sql/${krdba.dataSource.database}/mysql" prefix="mysql/server/data" />
                                            <zipfileset dir="${project.build.directory}/data-sql/${kpmedba.dataSource.database}/mysql" prefix="mysql/client/data" />
                                            <zipfileset dir="${project.build.directory}/mysql_${dba.environment}" />
                                        </zip>
                                    </target>
                                </configuration>
                            </execution>
                            <execution>
                                <id>create-scripts-oracle</id>
                                <phase>generate-sources</phase>
                                <goals>
                                    <goal>run</goal>
                                </goals>
                                <configuration>
                                    <target>
                                        <fileset id="oracle-server-schema" file="${project.build.directory}/schema-sql/${krdba.dataSource.database}/oracle/${krdba.dataSource.database}.sql" />
                                        <fileset id="oracle-server-constraints" file="${project.build.directory}/schema-sql/${krdba.dataSource.database}/oracle/${krdba.dataSource.database}-constraints.sql" />
                                        <fileset id="oracle-client-schema" file="${project.build.directory}/schema-sql/${kpmedba.dataSource.database}/oracle/${kpmedba.dataSource.database}.sql" />
                                        <fileset id="oracle-client-constraints" file="${project.build.directory}/schema-sql/${kpmedba.dataSource.database}/oracle/${kpmedba.dataSource.database}-constraints.sql" />
                                        <fileset id="oracle-server-data" dir="${project.build.directory}/data-sql/${krdba.dataSource.database}/oracle" />                                        
                                        <fileset id="oracle-client-data" dir="${project.build.directory}/data-sql/${kpmedba.dataSource.database}/oracle" />
                                        
                                        <pathconvert property="oracle-server-schema-script" refid="oracle-server-schema" pathsep="${line.separator}">
                                            <chainedmapper>
                                                <flattenmapper />
                                                <filtermapper>
                                                    <replacestring from="${krdba.dataSource.database}.sql" to="@oracle/server/schema/schema.sql" />
                                                </filtermapper>
                                            </chainedmapper>
                                        </pathconvert>
                                        <pathconvert property="oracle-server-constraints-script" refid="oracle-server-constraints" pathsep="${line.separator}">
                                            <chainedmapper>
                                                <flattenmapper />
                                                <filtermapper>
                                                    <replacestring from="${krdba.dataSource.database}-constraints.sql" to="@oracle/server/schema/schema-constraints.sql" />
                                                </filtermapper>
                                            </chainedmapper>
                                        </pathconvert>
                                        <pathconvert property="oracle-client-schema-script" refid="oracle-client-schema" pathsep="${line.separator}">
                                            <chainedmapper>
                                                <flattenmapper />
                                                <filtermapper>
                                                    <replacestring from="${kpmedba.dataSource.database}.sql" to="@oracle/client/data/schema.sql" />
                                                </filtermapper>
                                            </chainedmapper>
                                        </pathconvert>
                                        <pathconvert property="oracle-client-constraints-script" refid="oracle-client-constraints" pathsep="${line.separator}">
                                            <chainedmapper>
                                                <flattenmapper />
                                                <filtermapper>
                                                    <replacestring from="${kpmedba.dataSource.database}-constraints.sql" to="@oracle/client/schema/schema-constraints.sql" />
                                                </filtermapper>
                                            </chainedmapper>
                                        </pathconvert>
                                        <pathconvert property="oracle-server-data-script" refid="oracle-server-data" pathsep="${line.separator}">
                                            <chainedmapper>
                                                <flattenmapper />
                                                <globmapper from="*.sql" to="@oracle/server/data/*.sql" />
                                            </chainedmapper>
                                        </pathconvert>
                                        <pathconvert property="oracle-client-data-script" refid="oracle-client-data" pathsep="${line.separator}">
                                            <chainedmapper>
                                                <flattenmapper />
                                                <globmapper from="*.sql" to="@oracle/client/data/*.sql" />
                                            </chainedmapper>
                                        </pathconvert>
                                        
                                        <echo message="${oracle-server-schema-script}${line.separator}${oracle-server-data-script}${line.separator}${oracle-server-constraints-script}" file="${project.build.directory}/oracle_${dba.environment}/oracle_server.sql" />
                                        <echo message="${oracle-client-schema-script}${line.separator}${oracle-client-data-script}${line.separator}${oracle-client-constraints-script}" file="${project.build.directory}/oracle_${dba.environment}/oracle_client.sql" />
                                        
                                        <zip destfile="${project.build.directory}/oracle_${dba.environment}.zip">
                                            <zipfileset dir="${project.build.directory}/schema-sql/${krdba.dataSource.database}/oracle" includes="${krdba.dataSource.database}.sql" fullpath="oracle/server/schema/schema.sql" />
                                            <zipfileset dir="${project.build.directory}/schema-sql/${krdba.dataSource.database}/oracle" includes="${krdba.dataSource.database}-constraints.sql" fullpath="oracle/server/schema/schema-constraints.sql" />
                                            <zipfileset dir="${project.build.directory}/schema-sql/${kpmedba.dataSource.database}/oracle" includes="${kpmedba.dataSource.database}.sql" fullpath="oracle/client/schema/schema.sql" />
                                            <zipfileset dir="${project.build.directory}/schema-sql/${kpmedba.dataSource.database}/oracle" includes="${kpmedba.dataSource.database}-constraints.sql" fullpath="oracle/client/schema/schema-constraints.sql" />
                                            <zipfileset dir="${project.build.directory}/data-sql/${krdba.dataSource.database}/oracle" prefix="oracle/server/data" />
                                            <zipfileset dir="${project.build.directory}/data-sql/${kpmedba.dataSource.database}/oracle" prefix="oracle/client/data" />
                                            <zipfileset dir="${project.build.directory}/oracle_${dba.environment}" />
                                        </zip>
                                    </target>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
		        </plugins>
		    </build>
		</profile>
        <profile>
            <id>import</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.kuali.maven.plugins</groupId>
                        <artifactId>maven-impex-plugin</artifactId>
                        <executions>
                            <execution>
		                        <id>reset-kr</id>
		                        <phase>process-sources</phase>
		                        <goals>
		                            <goal>reset</goal>
		                        </goals>
		                        <configuration>
		                            <artifactId>${admin.dataSource.database}</artifactId>
		                            <driver>${admin.dataSource.driver}</driver>
		                            <url>${admin.dataSource.jdbcUrl}</url>
		                            <username>${admin.dataSource.username}</username>
		                            <password>${admin.dataSource.password}</password>
		                            <serverUrl>${admin.dataSource.jdbcUrl}</serverUrl>
		                            <database>${kr.dataSource.database}</database>
		                            <databaseUser>${kr.dataSource.username}</databaseUser>
		                            <databasePassword>${kr.dataSource.password}</databasePassword>
		                        </configuration>
		                    </execution>
		                    <execution>
                                <id>reset-kpme</id>
                                <phase>process-sources</phase>
                                <goals>
                                    <goal>reset</goal>
                                </goals>
                                <configuration>
                                    <artifactId>${admin.dataSource.database}</artifactId>
                                    <driver>${admin.dataSource.driver}</driver>
                                    <url>${admin.dataSource.jdbcUrl}</url>
                                    <username>${admin.dataSource.username}</username>
                                    <password>${admin.dataSource.password}</password>
                                    <serverUrl>${admin.dataSource.jdbcUrl}</serverUrl>
                                    <database>${kpme.dataSource.database}</database>
                                    <databaseUser>${kpme.dataSource.username}</databaseUser>
                                    <databasePassword>${kpme.dataSource.password}</databasePassword>
                                </configuration>
                            </execution>
		                    <execution>
		                        <id>import-schema-kr</id>
		                        <phase>process-sources</phase>
		                        <goals>
		                            <goal>import</goal>
		                        </goals>
		                        <configuration>
		                            <artifactId>${kr.dataSource.database}</artifactId>
		                            <driver>${kr.dataSource.driver}</driver>
		                            <url>${kr.dataSource.jdbcUrl}</url>
		                            <username>${kr.dataSource.username}</username>
		                            <password>${kr.dataSource.password}</password>
		                            <importDir>${project.build.directory}/schema-sql/${krdba.dataSource.database}</importDir>
		                            <importDirIncludes>${krdba.dataSource.database}.sql</importDirIncludes>
		                        </configuration>
		                    </execution>
		                    <execution>
		                        <id>import-data-kr</id>
		                        <phase>process-sources</phase>
		                        <goals>
		                            <goal>import</goal>
		                        </goals>
		                        <configuration>
		                            <artifactId>${kr.dataSource.database}</artifactId>
		                            <driver>${kr.dataSource.driver}</driver>
		                            <url>${kr.dataSource.jdbcUrl}</url>
		                            <username>${kr.dataSource.username}</username>
		                            <password>${kr.dataSource.password}</password>
		                            <importDir>${project.build.directory}/data-sql/${krdba.dataSource.database}</importDir>
		                        </configuration>
		                    </execution>
		                    <execution>
		                        <id>import-constraints-kr</id>
		                        <phase>process-sources</phase>
		                        <goals>
		                            <goal>import</goal>
		                        </goals>
		                        <configuration>
		                            <artifactId>${kr.dataSource.database}</artifactId>
		                            <driver>${kr.dataSource.driver}</driver>
		                            <url>${kr.dataSource.jdbcUrl}</url>
		                            <username>${kr.dataSource.username}</username>
		                            <password>${kr.dataSource.password}</password>
		                            <importDir>${project.build.directory}/schema-sql/${krdba.dataSource.database}</importDir>
		                            <importDirIncludes>${krdba.dataSource.database}-constraints.sql</importDirIncludes>
		                        </configuration>
		                    </execution>
		                    <execution>
                                <id>import-schema-kpme</id>
                                <phase>process-sources</phase>
                                <goals>
                                    <goal>import</goal>
                                </goals>
                                <configuration>
                                    <artifactId>${kpme.dataSource.database}</artifactId>
                                    <driver>${kpme.dataSource.driver}</driver>
                                    <url>${kpme.dataSource.jdbcUrl}</url>
                                    <username>${kpme.dataSource.username}</username>
                                    <password>${kpme.dataSource.password}</password>
                                    <importDir>${project.build.directory}/schema-sql/${kpmedba.dataSource.database}</importDir>
                                    <importDirIncludes>${kpmedba.dataSource.database}.sql</importDirIncludes>
                                </configuration>
                            </execution>
                            <execution>
                                <id>import-data-kpme</id>
                                <phase>process-sources</phase>
                                <goals>
                                    <goal>import</goal>
                                </goals>
                                <configuration>
                                    <artifactId>${kpme.dataSource.database}</artifactId>
                                    <driver>${kpme.dataSource.driver}</driver>
                                    <url>${kpme.dataSource.jdbcUrl}</url>
                                    <username>${kpme.dataSource.username}</username>
                                    <password>${kpme.dataSource.password}</password>
                                    <importDir>${project.build.directory}/data-sql/${kpmedba.dataSource.database}</importDir>
                                </configuration>
                            </execution>
                            <execution>
                                <id>import-constraints-kpme</id>
                                <phase>process-sources</phase>
                                <goals>
                                    <goal>import</goal>
                                </goals>
                                <configuration>
                                    <artifactId>${kpme.dataSource.database}</artifactId>
                                    <driver>${kpme.dataSource.driver}</driver>
                                    <url>${kpme.dataSource.jdbcUrl}</url>
                                    <username>${kpme.dataSource.username}</username>
                                    <password>${kpme.dataSource.password}</password>
                                    <importDir>${project.build.directory}/schema-sql/${kpmedba.dataSource.database}</importDir>
                                    <importDirIncludes>${kpmedba.dataSource.database}-constraints.sql</importDirIncludes>
                                </configuration>
                            </execution>
		                </executions>
		            </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <id>deploy</id>
            <build>
		        <resources>
		            <resource>
		                <directory>src/main/resources/${dba.environment}</directory>
		                <targetPath>${project.build.directory}/environment/${dba.environment}</targetPath>
		                <filtering>true</filtering>
		            </resource>
		            <resource>
		                <directory>src/main/resources/${build.environment}</directory>
		                <targetPath>${project.build.directory}/environment/${build.environment}</targetPath>
		                <filtering>true</filtering>
		            </resource>
		        </resources>
                <plugins>
                    <plugin>
		                <groupId>org.apache.maven.plugins</groupId>
		                <artifactId>maven-resources-plugin</artifactId>
		                <configuration>
		                    <useDefaultDelimiters>false</useDefaultDelimiters>
		                    <delimiters>
		                        <delimiter>@</delimiter>
		                    </delimiters>
		                </configuration>
		            </plugin>
		            <plugin>
		                <groupId>org.apache.maven.plugins</groupId>
		                <artifactId>maven-antrun-plugin</artifactId>
		                <executions>
		                    <execution>
		                        <phase>process-resources</phase>
		                        <goals>
		                            <goal>run</goal>
		                        </goals>
		                        <configuration>
		                            <target>
		                                <copy toDir="${user.home}/kuali/main">
		                                    <fileset dir="${project.build.directory}/environment" />
		                                </copy>
		                            </target>
		                        </configuration>
		                    </execution>
		                </executions>
		            </plugin>
		            <plugin>
		                <groupId>org.apache.maven.plugins</groupId>
		                <artifactId>maven-scm-plugin</artifactId>
		                <dependencies>
		                    <dependency>
		                        <groupId>com.google.code.maven-scm-provider-svnjava</groupId>
		                        <artifactId>maven-scm-provider-svnjava</artifactId>
		                        <version>2.0.3</version>
		                    </dependency>
		                </dependencies>
		                <configuration>
		                    <providerImplementations>
		                        <svn>javasvn</svn>
		                    </providerImplementations>
		                    
		                    <connectionUrl>scm:svn:http://svn.kuali.org/repos/kpme/${scmVersionUrl}</connectionUrl>
		                    <scmVersionType>${scmVersionType}</scmVersionType>
		                    <scmVersion>${scmVersion}</scmVersion>
		                </configuration>
		                <executions>
		                    <execution>
		                        <id>project-checkout</id>
		                        <phase>compile</phase>
		                        <goals>
		                            <goal>checkout</goal>
		                        </goals>
		                        <configuration>
		                            <checkoutDirectory>${project.build.directory}/checkout/kpme/${scmVersionUrl}/${scmVersion}</checkoutDirectory>
		                        </configuration>
		                    </execution>
		                </executions>
		            </plugin>
		            <plugin>
		                <groupId>org.apache.maven.plugins</groupId>
		                <artifactId>maven-invoker-plugin</artifactId>
		                <configuration>
		                    <streamLogs>true</streamLogs>
		                    <projectsDirectory>${project.build.directory}/checkout/kpme/${scmVersionUrl}/${scmVersion}</projectsDirectory>
		                    <cloneProjectsTo>${project.build.directory}/build</cloneProjectsTo>
		                    <settingsFile>${user.home}/.m2/settings.xml</settingsFile>
		                    <cloneClean>true</cloneClean>
		                    <pomIncludes>
		                        <pomInclude>pom.xml</pomInclude>
		                    </pomIncludes>
		                    <profiles>
                                <profile>${build.environment}</profile>
                            </profiles>
		                    <goals>
		                        <goal>clean</goal>
		                        <goal>package</goal>
		                    </goals>
		                    <properties>
		                        <build.environment>${build.environment}</build.environment>
		                        <maven.test.skip>true</maven.test.skip>
		                    </properties>
		                </configuration>
		                <executions>
		                    <execution>
		                        <phase>compile</phase>
		                        <goals>
		                            <goal>run</goal>
		                        </goals>
		                    </execution>
		                </executions>
		            </plugin>
                </plugins>
            </build>
        </profile>
    </profiles>
    
    <repositories>
        <repository>
            <id>kuali.nexus</id>
            <name>Nexus Repository Manager</name>
            <url>http://nexus.kuali.org/content/groups/public</url>
            <releases>
                <enabled>true</enabled>
            </releases>
            <snapshots>
                <enabled>true</enabled>
            </snapshots>
        </repository>
    </repositories>
    
    <pluginRepositories>
        <pluginRepository>
            <id>kuali.nexus</id>
            <name>Nexus Repository Manager</name>
            <url>http://nexus.kuali.org/content/groups/public</url>
            <releases>
                <enabled>true</enabled>
            </releases>
            <snapshots>
                <enabled>true</enabled>
            </snapshots>
        </pluginRepository>
    </pluginRepositories>

</project>